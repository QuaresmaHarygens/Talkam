from datetime import datetime
from uuid import UUID

from pydantic import BaseModel

from .common import Location, MediaRef, ReportSummary, TimelineEvent


class ReportCreateRequest(BaseModel):
    category: str
    severity: str
    anonymous: bool | None = False
    summary: str
    details: str | None = None
    media: list[MediaRef] = []
    location: Location
    witness_count: int | None = None
    offline_reference: str | None = None
    sms_reference: str | None = None


class ReportResponse(BaseModel):
    id: UUID
    status: str
    created_at: datetime
    summary: str
    details: str | None = None
    category: str
    severity: str
    location: Location
    verification_score: float | None = None
    media: list[MediaRef] = []
    timeline: list[TimelineEvent] = []


class VerificationRequest(BaseModel):
    action: str
    comment: str | None = None
    witness_count: int | None = None


class CommentRequest(BaseModel):
    body: str
    visibility: str = "reporter"


class SearchResponse(BaseModel):
    results: list[ReportSummary]
